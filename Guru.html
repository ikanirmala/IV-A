<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link id="favicon" rel="icon" type="image/x-icon" href="">
    <title>IKA NIRMALA</title>
    
    <script src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/jspdf-autotable@3.8.2/dist/jspdf.plugin.autotable.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-color: #4A90E2; --primary-dark: #357ABD; --secondary-color: #7F8C8D; 
            --success-color: #2ECC71; --danger-color: #E74C3C; --warning-color: #F1C40F; 
            --info-color: #3498DB; --light-color: #FDFEFE; --dark-color: #2C3E50; 
            --background-color: #F0F2F5; --text-color: #2C3E50; --card-bg-color: #FFFFFF; 
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.07);
            --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
            --border-radius: 16px; --border-color: #E2E8F0;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
        body { font-family: 'Poppins', sans-serif; background-color: var(--background-color); color: var(--text-color); line-height: 1.6; font-size: 14px; }
        
        #login-container { display: flex; justify-content: center; align-items: center; min-height: 100vh; background: linear-gradient(135deg, #4A90E2, #8E44AD); }
        .login-card { background: white; padding: 40px; border-radius: 20px; width: 100%; max-width: 400px; box-shadow: 0 20px 50px rgba(0,0,0,0.2); text-align: center; transform: scale(0.95); opacity: 0; animation: fadeUp 0.5s forwards; }

        #dashboard-container { display: flex; min-height: 100vh; }
        .sidebar { width: 260px; background-color: white; color: var(--dark-color); display: flex; flex-direction: column; position: fixed; height: 100vh; z-index: 100; box-shadow: 2px 0 10px rgba(0,0,0,0.05); transition: 0.3s; }
        .sidebar-header { padding: 30px 20px; text-align: center; border-bottom: 1px solid var(--background-color); }
        .sidebar-header h3 { font-weight: 700; color: var(--primary-color); letter-spacing: 1px; }
        .sidebar-nav { flex-grow: 1; padding: 20px 0; overflow-y: auto; perspective: 1000px; }
        
        .sidebar-nav .nav-link { 
            display: flex; align-items: center; gap: 12px; padding: 12px 25px; 
            color: var(--secondary-color); text-decoration: none; 
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); 
            font-weight: 500; font-size: 14px; border-left: 4px solid transparent; 
            cursor: pointer; transform-origin: left center;
        }
        
        .sidebar-nav .nav-link:hover, .sidebar-nav .nav-link.active { 
            background: linear-gradient(90deg, #F0F7FF 0%, #FFFFFF 100%); 
            color: var(--primary-color); 
            border-left-color: var(--primary-color);
            transform: scale(1.05) translateX(10px); 
            box-shadow: 5px 5px 15px rgba(74, 144, 226, 0.15); 
            z-index: 10;
        }

        .sidebar-nav .nav-link:hover i { animation: wiggle 0.5s ease-in-out; color: var(--primary-color); }
        @keyframes wiggle { 0%, 100% { transform: rotate(0deg); } 25% { transform: rotate(-15deg) scale(1.2); } 75% { transform: rotate(15deg) scale(1.2); } }
        
        .sidebar-submenu { overflow: hidden; transition: max-height 0.3s ease-out; background: #F8FAFC; margin: 0 15px; border-radius: 8px; }
        .sidebar-submenu .nav-link { padding-left: 45px; font-size: 13px; border-left: none; }
        .sidebar-submenu .nav-link:hover, .sidebar-submenu .nav-link.active-sub { color: var(--primary-color); background: #E0F2FE; border-radius: 8px; font-weight: 600; transform: scale(1.02) translateX(5px); }
        .arrow-icon { transition: transform 0.3s; font-size: 10px; margin-left: auto; }
        .arrow-icon.rotate { transform: rotate(90deg); }
        .main-content { flex-grow: 1; margin-left: 260px; padding: 30px; width: calc(100% - 260px); }

        .card { background: white; padding: 30px; border-radius: var(--border-radius); box-shadow: var(--shadow-sm); margin-bottom: 25px; border: 1px solid white; transition: 0.3s ease; }
        .card:hover { box-shadow: var(--shadow-md); }
        .card h3 { font-size: 18px; font-weight: 600; color: var(--dark-color); margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        .card h3 i { color: var(--primary-color); }

        .btn, .action-btn { padding: 10px 20px; border: none; border-radius: 10px; cursor: pointer; font-weight: 600; display: inline-flex; align-items: center; gap: 8px; transition: 0.3s; font-family: inherit; font-size: 13px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.15); }
        .btn-primary { background: linear-gradient(135deg, #4A90E2, #357ABD); color: white; }
        .btn-success { background: linear-gradient(135deg, #2ECC71, #27AE60); color: white; }
        .btn-danger { background: linear-gradient(135deg, #E74C3C, #C0392B); color: white; }
        .btn-info { background: linear-gradient(135deg, #3498DB, #2980B9); color: white; }
        .btn-warning { background: linear-gradient(135deg, #F1C40F, #F39C12); color: white; }
        .action-btn.edit { background-color: #EBF5FB; color: var(--info-color); box-shadow: none; }
        .action-btn.edit:hover { background-color: var(--info-color); color: white; }
        .action-btn.delete { background-color: #FDEDEC; color: var(--danger-color); box-shadow: none; }
        .action-btn.delete:hover { background-color: var(--danger-color); color: white; }
        .action-btn.download { background-color: #EAFAF1; color: var(--success-color); box-shadow: none; }

        .table-wrapper { overflow-x: auto; border-radius: 12px; border: 1px solid var(--border-color); margin-top: 20px; max-height: 65vh; background: white; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 16px 20px; text-align: left; border-bottom: 1px solid var(--border-color); white-space: nowrap; font-size: 13px; }
        th { background: #F8FAFC; font-weight: 600; color: #64748B; font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px; position: sticky; top: 0; z-index: 2; border-bottom: 2px solid var(--border-color); }
        tbody tr:hover { background-color: #F8FAFC; }
        
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; }
        .form-group { margin-bottom: 20px; position: relative; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 500; font-size: 13px; color: #64748B; transition: 0.3s; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 12px 15px; border-radius: 10px; border: 1px solid #CBD5E1; font-family: inherit; font-size: 14px; background: #F8FAFC; transition: 0.3s; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { background: white; border-color: var(--primary-color); box-shadow: 0 0 0 4px rgba(74, 144, 226, 0.1); }
        .full-width { grid-column: 1 / -1; }

        .settings-section-title { font-size: 14px; font-weight: 700; color: var(--secondary-color); text-transform: uppercase; letter-spacing: 1px; margin: 30px 0 15px; border-bottom: 2px solid #F1F5F9; padding-bottom: 10px; grid-column: 1 / -1; }
        .ibadah-card-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; animation: fadeUp 0.5s ease; }
        .ibadah-card { background: white; border: 1px solid var(--border-color); border-radius: 12px; padding: 20px; transition: 0.3s; position: relative; overflow: hidden; }
        .ibadah-card:hover { transform: translateY(-3px); box-shadow: var(--shadow-md); border-color: var(--primary-color); }
        .ibadah-card.active { background: #F0F7FF; border-color: var(--primary-color); }
        .ibadah-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .ibadah-title { font-weight: 600; font-size: 15px; display: flex; align-items: center; gap: 8px; }
        .ibadah-icon { width: 32px; height: 32px; background: #E0F2FE; color: var(--primary-color); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 14px; }
        
        .toggle-switch { position: relative; display: inline-block; width: 44px; height: 24px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #CBD5E1; transition: .4s; border-radius: 24px; }
        .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        input:checked + .slider { background-color: var(--success-color); }
        input:checked + .slider:before { transform: translateX(20px); }

        .predikat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px; margin-top: 25px; }
        .predikat-card { padding: 25px; border-radius: 20px; text-align: center; color: white; position: relative; overflow: hidden; transition: all 0.4s; }
        .predikat-card:hover { transform: translateY(-5px); }
        .predikat-card::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%); transform: rotate(45deg); pointer-events: none; opacity: 0; transition: opacity 0.5s ease; }
        .predikat-card:hover::before { opacity: 1; }
        .predikat-card.taat { background: linear-gradient(135deg, #059669, #34D399); box-shadow: 0 10px 25px rgba(16, 185, 129, 0.4); }
        .predikat-card.terbiasa { background: linear-gradient(135deg, #D97706, #FBBF24); box-shadow: 0 10px 25px rgba(245, 158, 11, 0.4); }
        .predikat-card.kurang { background: linear-gradient(135deg, #DC2626, #F87171); box-shadow: 0 10px 25px rgba(239, 68, 68, 0.4); }
        .predikat-icon { font-size: 32px; margin-bottom: 20px; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1)); transition: transform 0.4s ease; }
        .predikat-card:hover .predikat-icon { transform: scale(1.1) rotate(10deg); }
        .predikat-label { font-size: 11px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; opacity: 0.9; font-weight: 600; display: block; text-shadow: 0 1px 2px rgba(0,0,0,0.1); }
        .predikat-input { width: 100%; background: rgba(255, 255, 255, 0.2) !important; border: 2px solid rgba(255, 255, 255, 0.3) !important; border-radius: 12px; padding: 12px; color: white !important; text-align: center; font-weight: 700; font-size: 16px; backdrop-filter: blur(4px); transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .predikat-input:focus { background: rgba(255, 255, 255, 0.35) !important; border-color: white !important; transform: scale(1.05); box-shadow: 0 8px 20px rgba(0,0,0,0.15); outline: none; }
        .predikat-input::placeholder { color: rgba(255,255,255,0.6); font-weight: 400; }
        .input-group-animate { margin-bottom: 15px; position: relative; }

        .school-info-grid { display: grid; grid-template-columns: 200px 1fr; gap: 30px; align-items: start; }
        .school-logo-preview-container { text-align: center; padding: 20px; background: #F8FAFC; border-radius: 16px; border: 2px dashed #CBD5E1; }
        .school-logo-preview { width: 120px; height: 120px; object-fit: contain; margin-bottom: 15px; border-radius: 50%; box-shadow: var(--shadow-md); background: white; padding: 10px; }
        .school-form-fields { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }

        @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-up { animation: fadeUp 0.5s ease forwards; }
        .page { display: none; }
        .page.active { display: block; animation: fadeUp 0.4s ease; }

        .chart-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; margin-top: 20px; }
        .chart-wrapper { position: relative; height: 350px; background: white; padding: 20px; border-radius: 12px; border: 1px solid #E2E8F0; box-shadow: var(--shadow-sm); }
        .chart-title { font-size: 16px; font-weight: 600; color: var(--dark-color); margin-bottom: 15px; border-bottom: 1px solid #F1F5F9; padding-bottom: 10px; }

        @media (max-width: 768px) {
            .sidebar { width: 0; overflow: hidden; }
            .main-content { margin-left: 0; width: 100%; padding: 20px; }
            .school-info-grid { grid-template-columns: 1fr; }
            .predikat-grid { grid-template-columns: 1fr; }
            .school-form-fields { grid-template-columns: 1fr; }
            .chart-grid { grid-template-columns: 1fr; }
        }

        .controls-wrapper { display: flex; flex-wrap: wrap; justify-content: space-between; gap: 20px; align-items: flex-start; margin-bottom: 25px; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); backdrop-filter: blur(4px); align-items: center; justify-content: center; padding: 20px; }
        .modal.show { display: flex; }
        .modal-content { background: white; padding: 30px; border-radius: 20px; width: 100%; max-width: 800px; max-height: 90vh; overflow-y: auto; position: relative; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); animation: fadeUp 0.3s ease; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px solid #F1F5F9; }
        .modal-header h3 { font-size: 20px; color: var(--dark-color); }
        
        #edit-form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px; padding: 10px 0; }
        .checklist-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        .checklist-option { display: flex; align-items: center; gap: 10px; background-color: #F8FAFC; padding: 12px; border-radius: 10px; border: 1px solid transparent; cursor: pointer; transition: 0.2s; }
        .checklist-option:hover { border-color: var(--primary-color); background: white; }
        .checklist-option input { width: 1.2em; height: 1.2em; accent-color: var(--primary-color); }
        .lainnya-text-input { display: none; width: 100%; margin-top: 10px; }

        .gallery-preview { width: 100%; height: 160px; object-fit: cover; border-radius: 12px; border: 1px solid #E2E8F0; margin-bottom: 10px; transition: 0.3s; }
        .gallery-preview:hover { transform: scale(1.02); }
        .search-container { position: relative; margin-bottom: 0; }
        .search-container i { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #94A3B8; }
        .search-container input { padding-left: 45px !important; width: 250px; background: white; border-color: #E2E8F0; }

        .modal-modern-content { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); padding: 40px 30px; border-radius: 24px; width: 100%; max-width: 400px; text-align: center; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); border: 1px solid rgba(255, 255, 255, 0.5); animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); position: relative; overflow: visible; }
        .modal-icon-wrapper { width: 80px; height: 80px; background: #FEE2E2; color: #EF4444; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 32px; margin: -60px auto 20px; border: 4px solid white; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .modal-modern-title { font-size: 20px; font-weight: 700; color: #1E293B; margin-bottom: 10px; }
        .modal-modern-text { font-size: 14px; color: #64748B; line-height: 1.6; margin-bottom: 30px; }
        .modal-btn-group { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .btn-modern-cancel { background: #F1F5F9; color: #64748B; border: none; padding: 12px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: 0.3s; }
        .btn-modern-cancel:hover { background: #E2E8F0; color: #334155; }
        .btn-modern-delete { background: linear-gradient(135deg, #EF4444, #DC2626); color: white; border: none; padding: 12px; border-radius: 12px; font-weight: 600; cursor: pointer; box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3); transition: 0.3s; }
        .btn-modern-delete:hover { transform: translateY(-2px); box-shadow: 0 6px 15px rgba(239, 68, 68, 0.4); }
        @keyframes popIn { 0% { opacity: 0; transform: scale(0.8); } 100% { opacity: 1; transform: scale(1); } }

        /* --- TAMBAHAN CSS UNTUK SIDEBAR TOGGLE --- */
        .sidebar { 
            transition: transform 0.3s ease, width 0.3s ease; 
        }
        
        .main-content { 
            transition: margin-left 0.3s ease, width 0.3s ease; 
        }

        body.sidebar-collapsed .sidebar {
            transform: translateX(-100%);
            width: 0;
        }

        body.sidebar-collapsed .main-content {
            margin-left: 0;
            width: 100%;
        }

        /* Tombol Toggle */
        .btn-toggle-sidebar {
            background: white;
            border: 1px solid #E2E8F0;
            color: var(--secondary-color);
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 15px;
            transition: 0.3s;
        }
        .btn-toggle-sidebar:hover {
            background: #F1F5F9;
            color: var(--primary-color);
        }

    </style>
</head>
<body>

    <div id="login-container">
        <div class="login-card">
            <div style="font-size: 40px; color: var(--primary-color); margin-bottom: 10px;"><i class="fas fa-graduation-cap"></i></div>
            <h2 style="color: var(--dark-color); margin-bottom: 5px;">Login Guru</h2>
            <p style="margin: 0 0 30px; color: #94A3B8; font-size: 13px;">Panel Manajemen Kelas & Laporan 7KAIH</p>
            <form id="loginForm">
                <div class="form-group"><input type="text" id="username" placeholder="Username" required></div>
                <div class="form-group"><input type="password" id="password" placeholder="Password" required></div>
                <button type="submit" id="loginButton" class="btn btn-primary" style="width: 100%; justify-content: center; padding: 15px; font-size: 15px; margin-top: 10px;">Masuk</button>
                <a href="./" class="btn btn-danger" style="width: 50%; justify-content: center; padding: 15px; font-size: 15px; margin-top: 10px;"><i class="fas fa-home"></i></a>
            </form>
        </div>
    </div>

    <div id="dashboard-container" style="display: none;">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h3><i class="fas fa-school"></i> IV-A</h3>
            </div>
            <nav class="sidebar-nav">
                <a href="./" class="nav-link"><i class="fas fa-home"></i> Home</a>
                
                <div class="nav-item-dropdown">
                    <a href="javascript:void(0)" class="nav-link" id="nav-laporan-parent" onclick="toggleSidebarDropdown(this)">
                        <i class="fas fa-file-invoice"></i> 7KAIH <i class="fas fa-chevron-right arrow-icon"></i>
                    </a>
                    <div class="sidebar-submenu" id="submenu-laporan" style="display: none;">
                        <a href="javascript:void(0)" class="nav-link sub-link" onclick="openLaporanSub('grafik', this)"><i class="fas fa-chart-bar"></i> Grafik</a>
                        <a href="javascript:void(0)" class="nav-link sub-link" onclick="openLaporanSub('data', this)"><i class="fas fa-table"></i> Data</a>
                        <a href="javascript:void(0)" class="nav-link sub-link" onclick="openLaporanSub('nilai', this)"><i class="fas fa-star-half-alt"></i> Nilai 7K</a>
                        <a href="javascript:void(0)" class="nav-link sub-link" onclick="openLaporanSub('rekap', this)"><i class="fas fa-chart-pie"></i> Rekap</a>
                        <a href="javascript:void(0)" class="nav-link sub-link" onclick="openLaporanSub('predikat', this)"><i class="fas fa-award"></i> Predikat</a>
                        <a href="javascript:void(0)" class="nav-link sub-link" onclick="openLaporanSub('analisis', this)"><i class="fas fa-search-plus"></i> Analisis Rinci</a>
                        <a href="#" class="nav-link sub-link" data-page="page-pengaturan"><i class="fas fa-cogs"></i> Pengaturan 7KAIH</a>

                    </div>
                </div>

                <div class="nav-item-dropdown">
                    <a href="javascript:void(0)" class="nav-link" onclick="toggleSidebarDropdown(this)">
                        <i class="fas fa-chalkboard-teacher"></i> Sekolah <i class="fas fa-chevron-right arrow-icon"></i>
                    </a>
                    <div class="sidebar-submenu" style="display: none;">
                        <a href="#" class="nav-link sub-link" data-page="page-sekolah"><i class="fas fa-school"></i> Data Sekolah</a>
                        <a href="#" class="nav-link" data-page="page-siswa"><i class="fas fa-user-graduate"></i> Data Siswa</a>                        
                        <a href="#" class="nav-link sub-link" data-page="page-galeri"><i class="fas fa-images"></i> Galeri & YouTube</a>
                        <a href="#" class="nav-link sub-link" data-page="page-kelas"><i class="fas fa-info-circle"></i> Info Visual Kelas</a>
                    </div>
                </div>                

                <div class="nav-item-dropdown">
                    <a href="javascript:void(0)" class="nav-link" onclick="toggleSidebarDropdown(this)">
                        <i class="fas fa-chalkboard-teacher"></i> Kelas <i class="fas fa-chevron-right arrow-icon"></i>
                    </a>
                    <div class="sidebar-submenu" style="display: none;">                                     
                        
                        <a href="#" class="nav-link sub-link" data-page="page-pelajaran"><i class="fas fa-book"></i> Pelajaran</a>
                        <a href="#" class="nav-link sub-link" data-page="page-tp-list"><i class="fas fa-list"></i> Daftar TP</a>
                        <a href="#" class="nav-link sub-link" data-page="page-absensi"><i class="fas fa-calendar-check"></i> Absensi</a>
                        <a href="#" class="nav-link sub-link" data-page="page-jadpel"><i class="fas fa-calendar"></i> Jadwal Pelajaran</a>
                        <a href="#" class="nav-link sub-link" data-page="page-piket"><i class="fas fa-calendar"></i> Jadwal Piket</a>
                    </div>
                </div>

                <div class="nav-item-dropdown">
                    <a href="javascript:void(0)" class="nav-link" onclick="toggleSidebarDropdown(this)">
                        <i class="fas fa-star"></i> Nilai Mapel <i class="fas fa-chevron-right arrow-icon"></i>
                    </a>
                    <div class="sidebar-submenu" id="submenu-nilai" style="display: none;">
                        <div style="padding:10px; font-size:12px; color:#aaa;">Memuat Mapel...</div>
                    </div>
                </div> 

                <div class="nav-item-dropdown"> <a href="javascript:void(0)" class="nav-link" onclick="toggleSidebarDropdown(this)">
                        <i class="fas fa-star"></i> Kokurikuler <i class="fas fa-chevron-right arrow-icon"></i>
                    </a>
                    <div class="sidebar-submenu" style="display: none;">  
                        <a href="#" class="nav-link sub-link" data-page="page-tp-koku"><i class="fas fa-project-diagram"></i> TP Koku</a>                        
                        <a href="#" class="nav-link sub-link" data-page="page-nilai-koku"><i class="fas fa-project-diagram"></i> Nilai Koku</a>                        
                    </div> 
                </div>

                <div class="nav-item-dropdown"> <a href="javascript:void(0)" class="nav-link" onclick="toggleSidebarDropdown(this)">
                        <i class="fas fa-star"></i> Ekstrakurikuler <i class="fas fa-chevron-right arrow-icon"></i>
                    </a>
                    <div class="sidebar-submenu" style="display: none;">  
                        <a href="#" class="nav-link sub-link" data-page="page-tp-ekstra"><i class="fas fa-project-diagram"></i> TP Ekstrakurikuler</a>                        
                        <a href="#" class="nav-link sub-link" data-page="page-nilai-ekstra"><i class="fas fa-project-diagram"></i> Nilai Ekstra</a>                        
                    </div> 
                </div>

                <a href="#" class="nav-link" data-page="page-aplikasi"><i class="fas fa-database"></i> Data Aplikasi</a>
            </nav>
            <div style="padding: 20px;">
                <button id="logoutButtonSide" class="btn btn-danger" style="width: 100%; justify-content: center;"><i class="fas fa-sign-out-alt"></i> Logout</button>
            </div>
        </aside>

        <main class="main-content">
            <div class="header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <div style="display: flex; align-items: center;">
                    <button class="btn-toggle-sidebar" onclick="toggleSidebar()" title="Geser Menu"><i class="fas fa-bars"></i></button>
                    <div>
                        <h2 id="page-title" style="font-size: 24px; font-weight: 700; color: var(--dark-color);">Managemen Kelas</h2>
                        <p style="font-size: 13px; color: #94A3B8;">Selamat datang kembali di panel manajemen.</p>
                    </div>
                </div>
                <div id="guru-badge" style="background: white; padding: 8px 20px; border-radius: 50px; box-shadow: var(--shadow-sm); font-size: 13px; font-weight: 600; color: var(--primary-color); display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-user-circle" style="font-size: 20px;"></i> <span id="guru-name-display">Guru</span>
                </div>
            </div>

            <section id="page-laporan" class="page active">
                <div id="grafik-view" style="display:none; margin-bottom: 25px;">
                    <div class="card">
                        <div class="chart-title"><i class="fas fa-chart-bar"></i> Grafik 7 Kebiasaan Anak Indonesia Hebat (Kelas Ini)</div>
                        <div style="position: relative; height: 400px; width: 100%;">
                            <canvas id="guruGlobalChart"></canvas>
                        </div>
                    </div>
                </div>

                <div id="analisis-view" style="display:none; margin-bottom: 25px;">
                    <div class="settings-section-title">Analisis Ibadah</div>
                    <div id="analisis-ibadah-rinci-container" class="chart-grid"></div>

                    <div class="settings-section-title" style="margin-top: 30px;">Analisis Waktu</div>
                    <div class="chart-grid">
                        <div class="chart-wrapper"><div class="chart-title">Bangun Pagi</div><canvas id="guruBangunChart"></canvas></div>
                        <div class="chart-wrapper"><div class="chart-title">Tidur Cepat</div><canvas id="guruTidurChart"></canvas></div>
                    </div>

                    <div class="settings-section-title" style="margin-top: 30px;">Analisis Kegiatan</div>
                    <div class="chart-grid">
                        <div class="chart-wrapper"><div class="chart-title">Olahraga</div><canvas id="guruOlahragaChart"></canvas></div>
                        <div class="chart-wrapper"><div class="chart-title">Bermasyarakat</div><canvas id="guruMasyarakatChart"></canvas></div>
                        <div class="chart-wrapper"><div class="chart-title">Belajar</div><canvas id="guruBelajarChart"></canvas></div>
                    </div>

                    <div class="settings-section-title" style="margin-top: 30px;">Analisis Makanan Sehat</div>
                    <div class="card">
                        <div class="chart-title">Detail Konsumsi Makanan Sehat</div>
                        <div style="position: relative; height: 350px; width: 100%;"><canvas id="guruMakananChart"></canvas></div>
                    </div>
                </div>

                <div id="laporan-table-container" class="card">
                    <div class="controls-wrapper">
                        <div style="display: flex; flex-wrap: wrap; gap: 15px; align-items: center; width: 100%;">
                            <div style="display: flex; align-items: center; gap: 10px; background: #F8FAFC; padding: 5px 10px; border-radius: 10px; border: 1px solid #E2E8F0;">
                                <i class="far fa-calendar-alt" style="color: #94A3B8;"></i>
                                <input type="date" id="rep-startDate" style="border: none; background: transparent; padding: 5px; font-size: 13px;">
                                <span style="color: #94A3B8;">-</span>
                                <input type="date" id="rep-endDate" style="border: none; background: transparent; padding: 5px; font-size: 13px;">
                                <button class="btn btn-primary" style="padding: 5px 15px; font-size: 12px;" onclick="applyDateFilter()">Filter</button>
                            </div>
                            <div class="search-container" style="flex-grow: 1;">
                                <i class="fas fa-search"></i>
                                <input type="text" id="laporanSearch" onkeyup="filterLaporanTable()" placeholder="Cari Siswa..." style="width: 100%;">
                            </div>
                            <button id="btnDownloadRekap" class="action-btn download" onclick="downloadRekapPDF()" style="display: none;"><i class="fas fa-file-pdf"></i> PDF</button>
                        </div>
                    </div>

                    <div class="table-wrapper"><table id="laporanTable"><thead></thead><tbody></tbody><tfoot></tfoot></table></div>
                </div>
            </section>


            <section id="page-jadpel" class="page">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <h3><i class="fas fa-calendar-alt"></i> Jadwal Pelajaran Kelas</h3>
                        <button class="btn btn-info" onclick="loadJadwal()"><i class="fas fa-sync"></i> Refresh</button>
                    </div>

                    <div class="jadwal-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                        </div>
                </div>
            </section>

            <!-- SECTION ABSENSI UPDATE -->
            <section id="page-absensi" class="page">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <h3><i class="fas fa-calendar-times"></i> Jurnal Ketidakhadiran</h3>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-info" onclick="openRekapAbsensiModal()"><i class="fas fa-chart-pie"></i> Rekap Absensi</button>
                            <button class="btn btn-danger" onclick="openAbsensiModal()"><i class="fas fa-plus-circle"></i> Catat Siswa Tidak Hadir</button>
                        </div>
                    </div>
                    
                    <div style="background: #F8FAFC; padding: 15px; border-radius: 12px; border: 1px solid #E2E8F0; display: flex; flex-wrap: wrap; align-items: center; gap: 15px; margin-bottom: 20px;">
                        <i class="fas fa-filter" style="color: var(--secondary-color);"></i>
                        <span style="font-size: 13px; font-weight: 500;">Periode:</span>
                        
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <input type="date" id="filter-abs-start" class="form-control" style="border: 1px solid #CBD5E1; padding: 8px 12px; border-radius: 8px;">
                            <span style="font-size: 12px; color: #64748B;">s/d</span>
                            <input type="date" id="filter-abs-end" class="form-control" style="border: 1px solid #CBD5E1; padding: 8px 12px; border-radius: 8px;">
                        </div>

                        <button class="btn btn-primary btn-sm" onclick="loadAbsensiTable()"><i class="fas fa-search"></i> Tampilkan</button>
                    </div>

                    <p style="font-size:13px; color:#64748B; margin-bottom:15px;">Menampilkan data siswa yang <b>Sakit</b>, <b>Izin</b>, atau <b>Alpha</b> dalam periode di atas.</p>
                    
                    <div class="table-wrapper">
                        <table id="table-absensi">
                            <thead>
                                <tr>
                                    <th style="width: 50px;">No</th>
                                    <th style="width: 120px;">Tanggal</th> <th>Nama Siswa</th>
                                    <th>Keterangan</th>
                                    <th>Catatan</th>
                                    <th style="width: 100px;">Aksi</th>
                                </tr>
                            </thead>
                            <tbody>
                                </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="page-pelajaran" class="page">
                <div class="form-grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));">
                    <!-- SECTION MAPEL -->
                    <div class="card">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                            <h3><i class="fas fa-book"></i> Mata Pelajaran</h3>
                            <button class="btn btn-primary btn-sm" onclick="openPekModal('mapel')"><i class="fas fa-plus"></i> Tambah</button>
                        </div>
                        <p style="font-size:12px; color:#64748B; margin-bottom:15px;">Kelola nama pelajaran induk. TP dikelola di menu "Daftar TP".</p>
                        <div class="table-wrapper" style="max-height: 300px;">
                            <table id="table-mapel">
                                <thead><tr><th>Nama</th><th>Singkatan</th><th>Aksi</th></tr></thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>


                    <!-- SECTION EKSKUL -->
            <section id="page-tp-ekstra" class="page">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <h3><i class="fas fa-futbol"></i> Manajemen TP Ekstrakurikuler</h3>
                    </div>
                    
                    <div class="form-group" style="background: #F8FAFC; padding: 15px; border-radius: 12px; border: 1px solid #E2E8F0;">
                        <label style="font-weight: 600; color: var(--primary-color);">Pilih Ekstrakurikuler</label>
                        <div style="display: flex; gap: 10px;">
                            <select id="filter-ekskul-tp" onchange="loadTpEkstraTable()" style="font-size: 14px; padding: 10px; flex-grow: 1;">
                                <option value="">- Pilih Ekskul -</option>
                            </select>
                            <button class="btn btn-info" onclick="openPekModal('ekskul')" title="Tambah Nama Ekskul Baru"><i class="fas fa-plus"></i> Ekskul Baru</button>
                        </div>
                    </div>

                    <div id="ekstra-content-area" style="display: none;">
                        <hr style="border: 0; border-top: 1px solid #E2E8F0; margin: 20px 0;">
                        
                        <div id="ekskul-header-info" style="display:flex; background: #FFFBEB; border: 1px solid #FCD34D; padding: 15px; border-radius: 12px; margin-bottom: 20px; align-items: center; justify-content: space-between;">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <div style="width: 40px; height: 40px; background: #FEF3C7; color: #D97706; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 18px;">
                                    <i class="fas fa-trophy"></i>
                                </div>
                                <div>
                                    <h4 style="margin:0; color:#B45309; font-size:16px;" id="ekskul-title-display">Nama Ekskul</h4>
                                    <div style="font-size:12px; color:#D97706;">Kelola Nama Ekskul & Tujuan Pembelajaran</div>
                                </div>
                            </div>
                            <div style="display:flex; gap:10px;">
                                <button class="btn btn-info btn-sm" id="btn-edit-ekskul-header" title="Edit Nama Ekskul"><i class="fas fa-edit"></i> Edit</button>
                                <button class="btn btn-danger btn-sm" id="btn-delete-ekskul-header" title="Hapus Ekskul"><i class="fas fa-trash"></i> Hapus</button>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h4 style="margin: 0;">Daftar Tujuan Pembelajaran (TP)</h4>
                            <button class="btn btn-primary" onclick="openTpEkstraModal()"><i class="fas fa-plus"></i> Tambah TP</button>
                        </div>

                        <div class="table-wrapper">
                            <table id="table-tp-ekstra">
                                <thead>
                                    <tr>
                                        <th style="width: 50px;">No</th>
                                        <th>Deskripsi Tujuan Pembelajaran</th>
                                        <th style="width: 100px;">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <section id="page-nilai-ekstra" class="page">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3><i class="fas fa-medal"></i> Input Nilai Ekstrakurikuler</h3>
                        <button class="btn btn-info" onclick="loadNilaiEkstraTable()"><i class="fas fa-sync"></i> Refresh Data</button>
                    </div>

                    <div style="background: #E0F2FE; border-left: 4px solid #0284C7; padding: 15px; margin-bottom: 20px; font-size: 13px; color: #075985;">
                        <i class="fas fa-info-circle"></i> <b>Petunjuk:</b> 
                        Pilih <b>Predikat Nilai</b> dan <b>Capaian TP</b> untuk setiap siswa pada kolom Ekskul yang diikuti. <br>
                        Biarkan kosong (<b>-</b>) jika siswa tidak mengikuti ekskul tersebut.
                    </div>
                    
                    <div class="table-wrapper" style="max-height: 70vh; overflow-x: auto;">
                        <table id="table-nilai-ekstra" style="font-size: 12px; min-width: 100%;">
                            <thead>
                                </thead>
                            <tbody>
                                </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- SECTION BARU: PIKET -->
            <section id="page-piket" class="page">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <h3><i class="fas fa-broom"></i> Jadwal Piket Kebersihan</h3>
                        <button class="btn btn-info" onclick="loadPiket()"><i class="fas fa-sync"></i> Refresh</button>
                    </div>

                    <div class="piket-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                        </div>
                </div>
            </section>            

            <!-- SECTION BARU: MANAJEMEN TP -->
            <section id="page-tp-list" class="page">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <h3><i class="fas fa-list"></i> Manajemen Tujuan Pembelajaran (TP)</h3>
                        <button class="btn btn-primary" onclick="openTpModal()"><i class="fas fa-plus"></i> Tambah TP</button>
                    </div>
                    
                    <div class="form-group">
                        <label>Pilih Mata Pelajaran</label>
                        <select id="filter-mapel-tp" onchange="loadTpByMapel()">
                            <option value="">- Pilih Mapel -</option>
                        </select>
                    </div>

                    <div class="table-wrapper">
                        <table id="table-tp">
                            <thead>
                                <tr>
                                    <th style="width: 100px;">Kode TP</th>
                                    <th>Deskripsi Tujuan Pembelajaran</th>
                                    <th style="width: 120px;">Aksi</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td colspan="3" style="text-align: center; color: #94A3B8;">Silakan pilih mata pelajaran terlebih dahulu.</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="page-tp-koku" class="page">
                <div class="card" style="margin-bottom: 25px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                        <h3><i class="fas fa-layer-group"></i> Daftar Tema Projek</h3>
                        <button class="btn btn-primary btn-sm" onclick="openPekModal('koku')"><i class="fas fa-plus"></i> Tambah Tema Baru</button>
                    </div>
                    <p style="font-size:12px; color:#64748B; margin-bottom:15px;">Buat tema projek di sini terlebih dahulu sebelum mengisi detail kegiatan dan TP di bawah.</p>
                    <div class="table-wrapper" style="max-height: 250px;">
                        <table id="table-koku">
                            <thead><tr><th>Nama Projek</th><th>Aksi</th></tr></thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <h3><i class="fas fa-project-diagram"></i> Manajemen Kokurikuler</h3>
                    </div>
                    
                    <div class="form-group" style="background: #F8FAFC; padding: 15px; border-radius: 12px; border: 1px solid #E2E8F0;">
                        <label style="font-weight: 600; color: var(--primary-color);">Tema</label>
                        <select id="filter-koku-projek" onchange="loadKokuDetails()" style="font-size: 14px; padding: 10px;">
                            <option value="">- Tema -</option>
                            </select>
                        <textarea id="koku-kegiatan" rows="3" placeholder="Contoh: Siswa menanam pohon di lingkungan sekolah..." style="width: 100%;"></textarea>
                            <button class="btn btn-success btn-sm" onclick="saveKokuKegiatan()" style="margin-top: 10px;"><i class="fas fa-save"></i> Simpan Kegiatan</button>

                    </div>

                    <div id="koku-content-area" style="display: none;">
                        <hr style="border: 0; border-top: 1px solid #E2E8F0; margin: 20px 0;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h4 style="margin: 0;">Daftar Tujuan Pembelajaran (TP)</h4>
                            <button class="btn btn-primary" onclick="openTpKokuModal()"><i class="fas fa-plus"></i> Tambah TP Koku</button>
                        </div>

                        <div class="table-wrapper">
                            <table id="table-tp-koku">
                                <thead>
                                    <tr>
                                        <th style="width: 200px;">Dimensi</th>
                                        <th>Tujuan Pembelajaran</th>
                                        <th style="width: 100px;">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>


            <section id="page-nilai-koku" class="page">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3><i class="fas fa-project-diagram"></i> Input Nilai Kokurikuler</h3>
                        <button class="btn btn-info" onclick="loadNilaiKokuTable()"><i class="fas fa-sync"></i> Refresh Data</button>
                    </div>

                    <div style="background: #FFFBEB; border-left: 4px solid #F59E0B; padding: 15px; margin-bottom: 20px; font-size: 13px; color: #B45309;">
                        <i class="fas fa-info-circle"></i> <b>Petunjuk:</b> Pilih Predikat (SB, BSH, MB, BB). Sistem otomatis membuat Deskripsi narasi berdasarkan TP Tertinggi dan Terendah per Kegiatan.
                    </div>
                    
                    <div class="table-wrapper" style="max-height: 70vh;">
                        <table id="table-nilai-koku" style="font-size: 12px;">
                            <thead>
                                </thead>
                            <tbody>
                                </tbody>
                        </table>
                    </div>
                </div>
            </section>            

            <section id="page-nilai-dynamic" class="page">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 id="nilai-page-title"><i class="fas fa-star"></i> Input Nilai</h3>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-warning" onclick="openPredikatNilaiModal()"><i class="fas fa-sliders-h"></i> Predikat</button>
                            <button class="btn btn-info" onclick="refreshNilaiTable()"><i class="fas fa-sync"></i> Refresh Data</button>
                        </div>
                    </div>
                    
                    <div style="background: #F8FAFC; padding: 12px; border-radius: 10px; border: 1px solid #E2E8F0; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-search" style="color: #94A3B8;"></i>
                        <input type="text" id="filter-nama-nilai" placeholder="Cari siswa untuk input nilai..." 
                               style="border: none; background: transparent; width: 100%; outline: none; font-size: 13px;" 
                               onkeyup="filterNilaiList()">
                    </div>

                    <p style="font-size:13px; color:#64748B; margin-bottom:20px;">Masukkan nilai (0-100) untuk setiap Tujuan Pembelajaran (TP).</p>
                    
                    <div class="table-wrapper">
                        <table id="nilaiTable">
                            <thead>
                                </thead>
                            <tbody>
                                </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="page-siswa" class="page">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <h3><i class="fas fa-users"></i> Data Siswa Kelas <span id="span-kelas"></span></h3>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-success" onclick="openModal('siswaExcelModal')"><i class="fas fa-file-excel"></i> Import Excel</button>
                            <button class="btn btn-primary" onclick="openSiswaModal()"><i class="fas fa-plus"></i> Tambah Manual</button>
                        </div>
                    </div>

                    <div style="background: #F8FAFC; padding: 15px; border-radius: 12px; border: 1px solid #E2E8F0; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-search" style="color: #94A3B8;"></i>
                        <input type="text" id="filter-nama-siswa" placeholder="Ketik nama siswa untuk mencari..." 
                               style="border: none; background: transparent; width: 100%; outline: none;" 
                               onkeyup="filterSiswaList()">
                    </div>

                    <div class="table-wrapper">
                        <table id="siswaTable">
                            <thead>
                                <tr>
                                    <th>Foto</th>
                                    <th>Nama Lengkap</th>
                                    <th>No. Induk</th>
                                    <th>L/P</th>
                                    <th>Agama</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="page-sekolah" class="page">
                <div class="card animate-up">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3><i class="fas fa-university"></i> Identitas Sekolah</h3>
                        <button class="btn btn-success" onclick="saveSekolahData()"><i class="fas fa-save"></i> Simpan Perubahan</button>
                    </div>
                    <form id="sekolahForm" class="school-info-grid"></form>
                </div>
                
                <div class="card animate-up" style="animation-delay: 0.1s;">
                    <h3><i class="fas fa-bullhorn"></i> Visi, Misi & Sambutan Guru</h3>
                    <form id="infoForm" class="form-grid"></form>
                </div>
            </section>

            <section id="page-pengaturan" class="page">
                <div class="card animate-up">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <h3><i class="fas fa-sliders-h"></i> Pengaturan Sistem 7KAIH</h3>
                        <button class="btn btn-success" onclick="saveGlobalSettings()"><i class="fas fa-save"></i> Simpan Pengaturan</button>
                    </div>
                    <div id="pengaturan-container"></div>
                </div>
            </section>

            <section id="page-galeri" class="page">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <h3><i class="fas fa-images"></i> Galeri Kegiatan (Maks. 10)</h3>
                        <button class="btn btn-success" onclick="saveGaleri()"><i class="fas fa-save"></i> Simpan Galeri</button>
                    </div>
                    <div id="galeri-list" class="form-grid" style="grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));"></div>
                    <div class="settings-section-title" style="margin-top: 40px;"><i class="fab fa-youtube"></i> Video YouTube Highlight</div>
                    <div id="youtube-list" class="form-grid"></div>
                </div>
            </section>

            <section id="page-kelas" class="page">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <h3><i class="fas fa-chalkboard"></i> Visualisasi Informasi Kelas</h3>
                        <button class="btn btn-success" onclick="saveKelasVisual()"><i class="fas fa-save"></i> Simpan Info</button>
                    </div>
                    <form id="kelasVisualForm" class="form-grid"></form>
                </div>
            </section>

            <section id="page-aplikasi" class="page">
                <div class="card">
                    <h3><i class="fas fa-user-edit"></i> Edit Profil & Akun</h3>
                    <div style="text-align: center; margin-bottom: 25px; padding-bottom: 20px; border-bottom: 1px solid #F1F5F9;">
                        <img src="" id="preview-profile-foto" style="width: 120px; height: 120px; border-radius: 50%; object-fit: cover; border: 4px solid #E2E8F0; margin-bottom: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
                        <div style="font-size: 13px; color: #64748B; margin-bottom: 10px; font-weight: 500;">Foto Profil Guru (Tampil di Homepage)</div>
                        <div style="display: flex; justify-content: center; gap: 10px; max-width: 400px; margin: 0 auto; align-items: center;">
                             <input type="text" id="profile-foto-url" placeholder="URL Foto" style="display: none;">
                             <input type="file" id="f-profile-foto" style="display:none" onchange="handleFileUpload(this, 'profile-foto-url');">
                             <button type="button" class="btn btn-info btn-sm" onclick="document.getElementById('f-profile-foto').click()"><i class="fas fa-camera"></i> Ganti Foto</button>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group"><label>Nama Guru</label><input type="text" id="profile-nama"></div>
                        <div class="form-group"><label>NIP</label><input type="text" id="profile-nip" placeholder="Nomor Induk Pegawai"></div>
                        <div class="form-group"><label>Username</label><input type="text" id="profile-username"></div>
                        <div class="form-group"><label>Password</label><input type="text" id="profile-password"></div>
                        <div class="form-group"><label>Kelas</label><input type="text" placeholder="Pastikan Nama Kelas Sama dengan Kelas Yang ada di Data Siswa" id="profile-kelas"></div>
                    </div>
                    <button class="btn btn-success" onclick="updateGuruProfile()" style="margin-top: 20px;"><i class="fas fa-save"></i> Perbarui Profil</button>
                </div>

                <div class="form-grid">
                    <div class="card">
                        <h3><i class="fas fa-sync-alt"></i> Backup & Restore Data</h3>
                        <p style="font-size: 13px; color: #64748B; margin: 10px 0 20px;">Unduh data (Siswa, Laporan, Pengaturan) ke file JSON.</p>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <button class="btn btn-primary" onclick="backupSystem()"><i class="fas fa-download"></i> Unduh Backup</button>
                            <button class="btn btn-warning" onclick="document.getElementById('restoreInput').click()" style="background-color: #F59E0B; color: white; border: none;"><i class="fas fa-upload"></i> Restore Data</button>
                            <input type="file" id="restoreInput" accept=".json" style="display: none;" onchange="handleRestoreFile(this)">
                        </div>
                    </div>
                    <div class="card" style="border-color: #FECACA;">
                        <h3 style="color: var(--danger-color);"><i class="fas fa-exclamation-triangle"></i> Reset Laporan</h3>
                        <p style="font-size: 13px; color: #64748B; margin: 10px 0 20px;">Menghapus semua data laporan siswa di kelas ini.</p>
                        <button class="btn btn-danger" onclick="resetLaporan()"><i class="fas fa-trash"></i> Reset Data Laporan</button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- MODAL-MODAL -->
    <div id="msgModal" class="modal"><div class="modal-content" style="max-width: 400px; text-align: center;"><div style="margin-bottom: 15px; font-size: 50px; color: var(--info-color);"><i class="fas fa-info-circle"></i></div><h3 id="msgTitle" style="margin-bottom: 10px;">Pemberitahuan</h3><p id="msgText" style="color: #64748B; margin-bottom: 25px;"></p><div id="msgModalButtons" style="display: flex; justify-content: center; gap: 10px;"><button class="btn btn-primary" onclick="closeModal('msgModal')">Mengerti</button></div></div></div>

    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header"><h3><i class="fas fa-edit"></i> Edit Laporan Siswa</h3><span style="cursor:pointer; font-size: 24px; color: #94A3B8;" onclick="closeModal('editModal')"></span></div>
            <form id="editForm">
                <input type="hidden" id="editDocId">
                <div id="edit-form-grid"></div>
                <div style="text-align: right; margin-top: 25px; border-top: 1px solid #F1F5F9; padding-top: 20px;">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('editModal')" style="margin-right: 10px;">Batal</button>
                    <button type="button" class="btn btn-success" onclick="saveChanges()"><i class="fas fa-save"></i> Simpan Perubahan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- MODAL JADWAL -->
    <div id="jadwalModal" class="modal">
        <div class="modal-content" style="max-width: 450px;">
            <div class="modal-header">
                <h3>Tambah Jadwal: <span id="jadwalHariTitle"></span></h3>
                <span style="cursor:pointer; font-size: 24px;" onclick="closeModal('jadwalModal')"></span>
            </div>
            <form id="jadwalForm">
                <input type="hidden" id="jadwalHariInput">
                
                <div class="form-group">
                    <label>Jenis Kegiatan</label>
                    <select id="jadwalTipe" onchange="toggleJadwalInput()" style="width:100%; padding:10px; border-radius:8px; border:1px solid #ccc;">
                        <option value="Mapel">Mata Pelajaran</option>
                        <option value="Lainnya">Kegiatan Khusus</option>
                    </select>
                </div>

                <div class="form-group" id="group-mapel">
                    <label>Pilih Mata Pelajaran</label>
                    <select id="jadwalMapelSelect" style="width:100%; padding:10px; border-radius:8px; border:1px solid #ccc;">
                        <option value="">- Memuat Mapel... -</option>
                    </select>
                </div>

                <div class="form-group" id="group-lainnya" style="display:none;">
                    <label>Pilih Kegiatan</label>
                    <select id="jadwalLainnyaSelect" style="width:100%; padding:10px; border-radius:8px; border:1px solid #ccc;">
                        <option value="Upacara">Upacara</option>
                        <option value="Senam">Senam</option>
                        <option value="Rohani">Rohani</option>
                        <option value="Pembiasaan">Pembiasaan</option>
                        <option value="Ekstrakurikuler">Ekstrakurikuler</option>
                        <option value="Kokurikuler">Kokurikuler</option>
                        <option value="Istirahat">Istirahat</option>
                    </select>
                </div>

                <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 20px;">Simpan Jadwal</button>
            </form>
        </div>
    </div>


    <!-- MODAL ABSENSI -->
    <div id="absensiModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3><i class="fas fa-user-minus"></i> Catat Ketidakhadiran</h3>
                <span style="cursor:pointer; font-size: 24px;" onclick="closeModal('absensiModal')"></span>
            </div>
            <form id="absensiForm">
                <div class="form-grid" style="grid-template-columns: 1fr;">
                    <div class="form-group">
                        <label>Tanggal</label>
                        <input type="date" id="abs-input-date" required>
                    </div>
                    <div class="form-group">
                        <label>Nama Siswa</label>
                        <select id="abs-input-siswa" required>
                            <option value="">- Pilih Siswa -</option>
                            </select>
                    </div>
                    <div class="form-group">
                        <label>Keterangan</label>
                        <select id="abs-input-ket" required>
                            <option value="">- Pilih Alasan -</option>
                            <option value="Sakit">Sakit</option>
                            <option value="Izin">Izin</option>
                            <option value="Alpha">Alpha</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Catatan (Opsional)</label>
                        <textarea id="abs-input-note" rows="2" placeholder="Contoh: Demam tinggi / Acara Keluarga"></textarea>
                    </div>
                </div>
                <button type="submit" class="btn btn-danger" style="margin-top: 20px; width: 100%;">Simpan Data</button>
            </form>
        </div>
    </div>

<div id="rekapAbsensiModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3><i class="fas fa-clipboard-list"></i> Rekapitulasi Absensi Kelas</h3>
                <span style="cursor:pointer; font-size: 24px;" onclick="closeModal('rekapAbsensiModal')"></span>
            </div>
            
            <div class="form-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); background: #F8FAFC; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                <div class="form-group">
                    <label>Tanggal Mulai</label>
                    <input type="date" id="rekap-start-date">
                </div>
                <div class="form-group">
                    <label>Tanggal Akhir</label>
                    <input type="date" id="rekap-end-date">
                </div>
                <div class="form-group">
                    <label>Jumlah Hari Efektif</label>
                    <input type="number" id="rekap-effective-days" placeholder="Contoh: 20" min="1">
                </div>
                <div class="form-group" style="display: flex; align-items: flex-end;">
                    <button class="btn btn-primary" style="width: 100%; justify-content: center;" onclick="generateRekapAbsensi()">
                        <i class="fas fa-calculator"></i> Proses Rekap
                    </button>
                </div>
            </div>

            <div class="table-wrapper">
                <table id="table-rekap-absensi">
                    <thead>
                        <tr>
                            <th style="width: 40px;">No</th>
                            <th>Nama Siswa</th>
                            <th style="text-align: center; color: #F59E0B;">Sakit (S)</th>
                            <th style="text-align: center; color: #3B82F6;">Izin (I)</th>
                            <th style="text-align: center; color: #EF4444;">Alpha (A)</th>
                            <th style="text-align: center; font-weight: bold;">Total Ketidakhadiran</th>
                            <th style="text-align: center; background: #E0F2FE;">% Kehadiran</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td colspan="7" style="text-align:center; padding: 20px; color:#aaa;">Masukkan Tanggal & Hari Efektif, lalu klik Proses.</td></tr>
                    </tbody>
                </table>
            </div>

            <div style="margin-top: 20px; text-align: right;">
                <button class="btn btn-success" onclick="printRekapAbsensi()"><i class="fas fa-print"></i> Cetak / Download PDF</button>
            </div>
        </div>
    </div>

    <!-- MODAL P+E+K -->
    <div id="pekModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3 id="pekModalTitle">Input Data</h3>
                <span style="cursor:pointer; font-size: 24px;" onclick="closeModal('pekModal')"></span>
            </div>
            <form id="pekForm">
                <input type="hidden" id="pekId">
                <input type="hidden" id="pekType">
                <div id="pekFormFields" class="form-grid" style="grid-template-columns: 1fr;"></div>
                <button type="submit" class="btn btn-primary" style="margin-top: 20px; width: 100%;">Simpan Data</button>
            </form>
        </div>
    </div>

    <!--- Modal Predikat -->>
<div id="predikatNilaiModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3><i class="fas fa-sliders-h"></i> Konfigurasi Predikat & KKM</h3>
                <span style="cursor:pointer; font-size: 24px;" onclick="closeModal('predikatNilaiModal')"></span>
            </div>
            <div style="background: #F0F9FF; padding: 10px; border-radius: 8px; margin-bottom: 15px; font-size: 12px; color: #0369A1;">
                <i class="fas fa-info-circle"></i> Pengaturan ini berlaku untuk <b>semua mata pelajaran</b>.
            </div>
            <form id="predikatNilaiForm">
                <div style="margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px;">
                    <label style="font-weight: bold; color: var(--success-color);">Predikat A (Sangat Baik)</label>
                    <div style="display: flex; gap: 10px; margin-top: 5px;">
                        <input type="number" id="pred-a-min" placeholder="Min (90)" style="width: 80px;" required>
                        <input type="text" id="pred-a-label" placeholder="Label (Sangat Baik)" style="flex: 1;" required>
                    </div>
                    <small style="color: #aaa;">Nilai >= Angka Minimal</small>
                </div>

                <div style="margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px;">
                    <label style="font-weight: bold; color: var(--info-color);">Predikat B (Baik)</label>
                    <div style="display: flex; gap: 10px; margin-top: 5px;">
                        <input type="number" id="pred-b-min" placeholder="Min (70)" style="width: 80px;" required>
                        <input type="text" id="pred-b-label" placeholder="Label (Baik)" style="flex: 1;" required>
                    </div>
                    <small style="color: #aaa;">Nilai >= Angka Minimal</small>
                </div>

                <div style="margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px;">
                    <label style="font-weight: bold; color: var(--warning-color);">Predikat C (Cukup)</label>
                    <div style="display: flex; gap: 10px; margin-top: 5px;">
                        <input type="number" id="pred-c-min" placeholder="Min (60)" style="width: 80px;" required>
                        <input type="text" id="pred-c-label" placeholder="Label (Cukup)" style="flex: 1;" required>
                    </div>
                    <small style="color: #aaa;">Nilai >= Angka Minimal</small>
                </div>

                <div style="margin-bottom: 15px;">
                    <label style="font-weight: bold; color: var(--danger-color);">Predikat D (Perlu Peningkatan)</label>
                    <div style="display: flex; gap: 10px; margin-top: 5px;">
                        <input type="number" value="0" disabled style="width: 80px; background: #eee;">
                        <input type="text" id="pred-d-label" placeholder="Label (Perlu Peningkatan)" style="flex: 1;" required>
                    </div>
                    <small style="color: #aaa;">Nilai di bawah batas Cukup</small>
                </div>

                <button type="submit" class="btn btn-primary" style="width: 100%;">Simpan Konfigurasi</button>
            </form>
        </div>
    </div>

    <!-- MODAL TP BARU -->
    <div id="tpModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3>Kelola Tujuan Pembelajaran</h3>
                <span style="cursor:pointer; font-size: 24px;" onclick="closeModal('tpModal')"></span>
            </div>
            <form id="tpForm">
                <input type="hidden" id="tpId">
                <input type="hidden" id="tpMapelId">
                <div class="form-grid" style="grid-template-columns: 1fr;">
                    <div class="form-group">
                        <label>Kode TP</label>
                        <input type="text" id="tpKode" placeholder="Contoh: TP.1.1" required>
                    </div>
                    <div class="form-group">
                        <label>Deskripsi Tujuan Pembelajaran</label>
                        <textarea id="tpDeskripsi" rows="3" placeholder="Contoh: Peserta didik mampu..." required></textarea>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary" style="margin-top: 20px; width: 100%;">Simpan TP</button>
            </form>
        </div>
    </div>

    <!-- MODAL TP ESKUL -->
    <div id="tpEkstraModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3>Kelola TP Ekstrakurikuler</h3>
                <span style="cursor:pointer; font-size: 24px;" onclick="closeModal('tpEkstraModal')"></span>
            </div>
            <form id="tpEkstraForm">
                <input type="hidden" id="tpEkstraId">
                <input type="hidden" id="tpEkstraRefId"> <div class="form-grid" style="grid-template-columns: 1fr;">
                    <div class="form-group">
                        <label>Deskripsi Tujuan Pembelajaran</label>
                        <textarea id="tpEkstraDeskripsi" rows="3" placeholder="Contoh: Siswa mampu melakukan teknik dasar passing..." required></textarea>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary" style="margin-top: 20px; width: 100%;">Simpan TP</button>
            </form>
        </div>
    </div>


    <!-- MODAL TP KOKU -->
    <div id="tpKokuModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3>Kelola TP Kokurikuler</h3>
                <span style="cursor:pointer; font-size: 24px;" onclick="closeModal('tpKokuModal')"></span>
            </div>
            <form id="tpKokuForm">
                <input type="hidden" id="tpKokuId">
                <input type="hidden" id="tpKokuProjekId">
                
                <div class="form-grid" style="grid-template-columns: 1fr;">
                    <div class="form-group">
                        <label>Dimensi</label>
                        <select id="tpKokuDimensi" required>
                            <option value="">- Pilih Dimensi -</option>
                            <option value="Keimanan dan Ketaqwaan">Keimanan dan Ketaqwaan</option>
                            <option value="Kewargaan">Kewargaan</option>
                            <option value="Penalaran Kritis">Penalaran Kritis</option>
                            <option value="Kreativitas">Kreativitas</option>
                            <option value="Kolaborasi">Kolaborasi</option>
                            <option value="Kemandirian">Kemandirian</option>
                            <option value="Kesehatan">Kesehatan</option>
                            <option value="Komunikasi">Komunikasi</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Tujuan Pembelajaran</label>
                        <textarea id="tpKokuDeskripsi" rows="3" placeholder="Deskripsi capaian..." required></textarea>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary" style="margin-top: 20px; width: 100%;">Simpan TP</button>
            </form>
        </div>
    </div>

        <!-- MODAL PIKET -->
    <div id="piketModal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3>Piket Hari: <span id="piketHariTitle"></span></h3>
                <span style="cursor:pointer; font-size: 24px;" onclick="closeModal('piketModal')"></span>
            </div>
            <form id="piketForm">
                <input type="hidden" id="piketHariInput">
                
                <div class="form-group">
                    <label>Pilih Siswa</label>
                    <select id="piketSiswaSelect" style="width:100%; padding:10px; border-radius:8px; border:1px solid #ccc;" required>
                        <option value="">- Memuat Data... -</option>
                    </select>
                    <small style="color: #64748B; display:block; margin-top:5px;">
                        *Hanya menampilkan siswa yang <b>belum</b> mendapatkan jadwal piket.
                    </small>
                </div>

                <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 20px;">Simpan</button>
            </form>
        </div>
    </div>

    <!-- MODAL SISWA -->
    <div id="siswaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header"><h3 id="siswaModalTitle">Data Siswa</h3><span style="cursor:pointer; font-size: 24px; color: #94A3B8;" onclick="closeModal('siswaModal')"></span></div>
            <form id="siswaForm">
                <input type="hidden" id="siswaId">
                <div class="form-grid">
                    <div class="form-group"><label>Nama Lengkap</label><input type="text" id="siswaNama" required placeholder="Contoh: Budi Santoso"></div>
                    <div class="form-group"><label>No. Induk</label><input type="text" id="siswaInduk" required placeholder="NIS/NISN"></div>
                    <div class="form-group"><label>Jenis Kelamin</label><select id="siswaGender"><option value="">- Pilih -</option><option value="Laki-laki">Laki-laki</option><option value="Perempuan">Perempuan</option></select></div>
                    <div class="form-group"><label>Agama</label><select id="siswaAgama"><option>Islam</option><option>Kristen</option><option>Katolik</option><option>Hindu</option><option>Buddha</option><option>Konghucu</option></select></div>
                    <div class="form-group"><label>Foto Siswa</label><div style="display:flex;gap:10px"><input type="text" id="siswaFoto" placeholder="URL Foto"><button type="button" class="btn btn-info" onclick="document.getElementById('f-siswa').click()"><i class="fas fa-folder-open"></i></button><input type="file" id="f-siswa" style="display:none" onchange="handleFileUpload(this, 'siswaFoto')"></div></div>
                </div>
                <button type="submit" class="btn btn-primary" style="margin-top: 25px; width: 100%; justify-content: center;">Simpan Data Siswa</button>
            </form>
        </div>
    </div>

    <!-- MODAL IMPORT EXCEL -->
    <div id="siswaExcelModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header"><h3>Import Data via Excel</h3><span style="cursor:pointer; font-size: 24px;" onclick="closeModal('siswaExcelModal')"></span></div>
            <div style="padding: 10px 0;">
                <p style="font-size: 13px; color: #64748B; margin-bottom: 20px;">Unduh format, isi data siswa (termasuk jenis kelamin), lalu upload kembali.</p>
                <button class="btn btn-success" onclick="downloadSiswaExcel()" style="width: 100%; margin-bottom: 20px;"><i class="fas fa-download"></i> Download Format Excel</button>
                <div style="border: 2px dashed #CBD5E1; padding: 30px; text-align: center; border-radius: 12px; background: #F8FAFC;">
                    <i class="fas fa-cloud-upload-alt" style="font-size: 40px; color: var(--primary-color); margin-bottom: 15px;"></i>
                    <input type="file" id="excelInput" accept=".xlsx, .xls" style="display: block; width: 100%; margin-top: 10px;">
                </div>
                <button class="btn btn-primary" style="width: 100%; margin-top: 20px;" onclick="uploadSiswaExcel()">Upload & Proses Data</button>
            </div>
        </div>
    </div>

    <!-- MODAL KONFIRMASI DELETE -->
    <div id="deleteConfirmModal" class="modal">
        <div class="modal-modern-content">
            <div class="modal-icon-wrapper"><i class="fas fa-trash-alt animate-pulse"></i></div>
            <h3 class="modal-modern-title">Konfirmasi Penghapusan</h3>
            <p class="modal-modern-text">Apakah Anda yakin ingin menghapus data ini? <br>Tindakan ini bersifat <strong>permanen</strong>.</p>
            <div class="modal-btn-group">
                <button class="btn-modern-cancel" onclick="closeModal('deleteConfirmModal')">Batal</button>
                <button class="btn-modern-delete" id="btnConfirmDelete">Ya, Hapus</button>
            </div>
        </div>
    </div>


<script src="Bangbin7KAIH.js"></script>
<script></script>
</body>
</html>
